var db=openDatabase("traineeDB","1.0","Trainee DB",2097152),msg,topics,currentTopic="",prefix="NAVYTG";db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS NOTES (ID INTEGER PRIMARY KEY ASC, title, note, modified DATETIME)")}),$.extend($.expr[":"],{containsIN:function(t,e,n,o){return(t.textContent||t.innerText||"").toLowerCase().indexOf((n[3]||"").toLowerCase())>=0}}),$(document).ready(function(){function t(t,e){return t.length>e&&(t=t.substr(0,e),t+="..."),t}function e(){$(".all-notes").empty(),db.transaction(function(e){e.executeSql("SELECT * FROM NOTES",[],function(e,n){var o=n.rows.length,i;for(msg="Found rows: "+o,console.log(msg),1===o?$("#notes-counter").text(o+" note"):$("#notes-counter").text(o+" notes"),i=0;o>i;i++){msg=n.rows.item(i).title,console.log(n.rows.item(i).ID,msg);var a='<a href="#" data-id="'+n.rows.item(i).ID+'" data-modified="'+n.rows.item(i).modified+'" class="note-link"><div class="note"><small class="date note-modified">'+n.rows.item(i).modified+"</small><h4>"+t(n.rows.item(i).title,40)+"</h4><p>"+t(n.rows.item(i).note,120)+"</p></div></a>";$(".all-notes").append($(a))}},null)})}function n(){function t(){$("[data-save]").each(function(){localStorage.setItem(prefix+"/"+currentTopic+"-"+$(this).attr("data-save"),$(this).val())})}function n(){$("[data-save]").each(function(){$(this).val(localStorage.getItem(prefix+"/"+currentTopic+"-"+$(this).attr("data-save")))})}function o(){$("#sectionNav").empty(),$("#portal [data-sectionTitle]").each(function(){var t='<li><a href="#" data-sectionTarget="'+$(this).attr("data-sectionTitle")+'"">'+$(this).attr("data-sectionTitle")+"</a></li>";$(t).appendTo("#sectionNav")})}function i(){$.each(topics,function(t){var e='<li><a href="'+t+'" class="">'+this.title+"</a></li>";$(e).appendTo("#topicNav")})}function a(t){currentTopic=t.id,$("#portal").load(t.location,function(){$("#topic-title").text(t.title),$(".hero").css("background-image","url('"+t.image+"')"),n(),o(),$(window).scrollTop(0)})}function c(){var t=$("#portal").clone();t.text($("#topic-title").text()+"\n"+t.text()),t.find("input").each(function(){$(this).replaceWith("[ANSWER: "+$(this).val()+"]")});var e=t.text(),n=e.replace(/^[ \t\r]+\b/gm,"");e=n,n=e.replace(/^\s*?(?=\[)/gm,"\n"),e=n,n=e.replace(/^\s+$/gm,"\n"),e=n,n=e.replace(/^\n+/gm,"\n"),console.log(n),$(".exportContainer").html(n)}e(),$(".save-note-button").click(function(){var t=$("#new-note-title").val(),n=$("#new-note-note").val(),o=new Date;db.transaction(function(i){i.executeSql("INSERT INTO NOTES (title, note, modified) VALUES (?,?,?)",[t,n,o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear()],e)})}),$("#new-note, #edit-note").on("hidden.bs.modal",function(){$("#new-note .modal-input").val("")}),$(".all-notes").on("click","a",function(){var t=$(this).attr("data-id");db.transaction(function(e){e.executeSql("SELECT * FROM NOTES WHERE ID=?",[t],function(t,e){$("#edit-note-title").val(e.rows.item(0).title),$("#edit-note-note").val(e.rows.item(0).note),$(".edit-save-note-button").data("ID",e.rows.item(0).ID),$(".edit-delete-note-button").data("ID",e.rows.item(0).ID),$("#edit-note").modal()},null)})}),$(".edit-delete-note-button").click(function(){var t=$(this).data("ID");console.log(t),db.transaction(function(n){n.executeSql("DELETE FROM NOTES WHERE ID=?",[t],function(){e()})})}),$(".edit-save-note-button").click(function(){var t=$("#edit-note-title").val(),n=$("#edit-note-note").val(),o=$(this).data("ID");console.log(t,n,o),db.transaction(function(i){i.executeSql("UPDATE NOTES SET title=?, note=? WHERE ID=?",[t,n,o],e)})}),n(),$("#portal").on("keyup","[data-save]",function(){t()}),a(topics[0]),i(),$("#topicNav").on("click","a",function(){return a(topics[$(this).attr("href")]),$(this).addClass("selected").parent().siblings().children().removeClass("selected"),$(".dropdown.open .dropdown-toggle").dropdown("toggle"),!1}),$("#sectionNav").on("click","a",function(){var t=$(this);return $(window).scrollTop($('[data-sectionTitle="'+t.attr("data-sectionTarget")+'"]').offset().top-70),$(".dropdown.open .dropdown-toggle").dropdown("toggle"),!1}),$("#search").keyup(function(){var t=$(this).val(),e=$(this);t.length>0?($("#portal").unhighlight().highlight(t),e.siblings(".fa").hide().siblings("#search-clear").show(),$("#search-count").text("Found "+$("#portal .highlight").length)):($("#portal").unhighlight(),$("#search-count").text(""),e.siblings("#search-clear").hide().siblings(".fa").show(),$("#search-count").text(""))}),$("#search-clear").click(function(){$("#search").val("").trigger("keyup")}),$("#export").click(function(){c()}),$(".copy-button").click(function(){return $(".exportContainer")[0].focus(),$(".exportContainer")[0].setSelectionRange(0,9999999),!1})}FastClick.attach(document.body),$.getJSON("topics.json",function(t){topics=t,n()}),$.getJSON("help.json",function(t){$.each(t,function(){var t='<div class="help-item"><div class="help-question">'+this.question+'</div><div class="help-answer">'+this.answer+"</div></div>";$(t).appendTo(".help-items")}),$(".help-question").click(function(){$(this).toggleClass("open").siblings(".help-answer").toggle()}),$(".help-search").keyup(function(){""!=$(".help-search").val()?($(".help-item").hide(),$('.help-question:containsIN("'+$(".help-search").val()+'")').parent().show()):$(".help-item").show()})})});
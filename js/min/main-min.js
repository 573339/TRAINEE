var db=openDatabase("traineeDB","1.0","Trainee DB",2097152),msg,topics,currentTopic="",prefix="NAVYTG";db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS NOTES (ID INTEGER PRIMARY KEY ASC, title, note, modified DATETIME)")}),$.extend($.expr[":"],{containsIN:function(t,e,i,o){return(t.textContent||t.innerText||"").toLowerCase().indexOf((i[3]||"").toLowerCase())>=0}}),$(document).ready(function(){function t(t,e){return t.length>e&&(t=t.substr(0,e),t+="..."),t}function e(){$(".all-notes").empty(),db.transaction(function(e){e.executeSql("SELECT * FROM NOTES",[],function(e,i){var o=i.rows.length,n;for(msg="Found rows: "+o,console.log(msg),1===o?$("#notes-counter").text(o+" note"):$("#notes-counter").text(o+" notes"),n=0;o>n;n++){msg=i.rows.item(n).title,console.log(i.rows.item(n).ID,msg);var a='<a href="#" data-id="'+i.rows.item(n).ID+'" data-modified="'+i.rows.item(n).modified+'" class="note-link"><div class="note"><small class="date note-modified">'+i.rows.item(n).modified+"</small><h4>"+t(i.rows.item(n).title,40)+"</h4><p>"+t(i.rows.item(n).note,120)+"</p></div></a>";$(".all-notes").append($(a))}},null)})}function i(){function t(){$("[data-save]").each(function(){localStorage.setItem(prefix+"/"+currentTopic+"-"+$(this).attr("data-save"),$(this).val())})}function i(){$("[data-save]").each(function(){$(this).val(localStorage.getItem(prefix+"/"+currentTopic+"-"+$(this).attr("data-save")))})}function o(){$("#sectionNav").empty(),$("#portal [data-sectionTitle]").each(function(){var t='<li><a href="#" data-sectionTarget="'+$(this).attr("data-sectionTitle")+'"">'+$(this).attr("data-sectionTitle")+"</a></li>";$(t).appendTo("#sectionNav")}),$("#portal [data-sectionTitle]").length<=1?$(".sectionNav-button").hide():$(".sectionNav-button").show()}function n(){$.each(topics,function(t){var e='<li><a href="'+t+'" class="">'+this.title+"</a></li>";$(e).appendTo("#topicNav")}),s()}function a(t){currentTopic=t.id,$("#portal").load(t.location,function(){$("#topic-title").text(t.title),$(".hero").css("background-image","url('"+t.image+"')"),i(),o(),$(window).scrollTop(0)})}function c(){var t=$("#portal").clone();t.text($("#topic-title").text()+"\n"+t.text()),t.find("input").each(function(){$(this).replaceWith("[ANSWER: "+$(this).val()+"]")});var e=t.text(),i=e.replace(/^[ \t\r]+\b/gm,"");e=i,i=e.replace(/^\s*?(?=\[)/gm,"\n"),e=i,i=e.replace(/^\s+$/gm,"\n"),e=i,i=e.replace(/^\n+/gm,"\n"),console.log(i),$(".exportContainer").html(i)}function s(){console.log("reset"),$("#topicNav-search").val(""),$("#topicNav li").show().removeClass("even"),$("#topicNav li:even").addClass("even")}e(),$(".save-note-button").click(function(){var t=$("#new-note-title").val(),i=$("#new-note-note").val(),o=new Date;db.transaction(function(n){n.executeSql("INSERT INTO NOTES (title, note, modified) VALUES (?,?,?)",[t,i,o.getMonth()+1+"/"+o.getDate()+"/"+o.getFullYear()],e)})}),$("#new-note, #edit-note").on("hidden.bs.modal",function(){$("#new-note .modal-input").val("")}),$(".all-notes").on("click","a",function(){var t=$(this).attr("data-id");db.transaction(function(e){e.executeSql("SELECT * FROM NOTES WHERE ID=?",[t],function(t,e){$("#edit-note-title").val(e.rows.item(0).title),$("#edit-note-note").val(e.rows.item(0).note),$(".edit-save-note-button").data("ID",e.rows.item(0).ID),$(".edit-delete-note-button").data("ID",e.rows.item(0).ID),$("#edit-note").modal()},null)})}),$(".edit-delete-note-button").click(function(){var t=$(this).data("ID");console.log(t),db.transaction(function(i){i.executeSql("DELETE FROM NOTES WHERE ID=?",[t],function(){e()})})}),$(".edit-save-note-button").click(function(){var t=$("#edit-note-title").val(),i=$("#edit-note-note").val(),o=$(this).data("ID");console.log(t,i,o),db.transaction(function(n){n.executeSql("UPDATE NOTES SET title=?, note=? WHERE ID=?",[t,i,o],e)})}),i(),$("#portal").on("keyup","[data-save]",function(){t()}),a(topics[0]),n(),$("#topicNav").on("click","a",function(){return a(topics[$(this).attr("href")]),$(this).addClass("selected").parent().siblings().children().removeClass("selected"),$(".topicNav-wrapper,.shroud").hide(),s(),!1}),$("#sectionNav").on("click","a",function(){var t=$(this);return $(window).scrollTop($('[data-sectionTitle="'+t.attr("data-sectionTarget")+'"]').offset().top-70),$("#sectionNav,.shroud").hide(),!1}),$("#search").keyup(function(){var t=$(this).val(),e=$(this);t.length>0?($("#portal").unhighlight().highlight(t),e.siblings(".fa").hide().siblings("#search-clear").show(),$("#search-count").text("Found "+$("#portal .highlight").length)):($("#portal").unhighlight(),$("#search-count").text(""),e.siblings("#search-clear").hide().siblings(".fa").show(),$("#search-count").text(""))}),$("#search-clear").click(function(){$("#search").val("").trigger("keyup")}),$("#export").click(function(){c()}),$(".copy-button").click(function(){return $(".exportContainer")[0].focus(),$(".exportContainer")[0].setSelectionRange(0,9999999),!1}),$(".sectionNav-button").click(function(){return $("#sectionNav, .shroud").toggle(),!1}),$(".topicNav-button").click(function(){return $(".topicNav-wrapper, .shroud").toggle(),!1}),$(window).click(function(){$("#sectionNav, .topicNav-wrapper").hide(),$(".shroud").hide(),s()}),$(".topicNav-search-wrapper").click(function(t){var e=$(t.target);e.is("#topicNav-search-clear")&&(s(),console.log("hi"),$("#topicNav-search-clear").hide().siblings(".fa").show()),t.stopPropagation()}),$("#topicNav-search").keyup(function(){""!=$("#topicNav-search").val()?($("#topicNav li").hide(),$('#topicNav li a:containsIN("'+$(this).val()+'")').parent().show(),$("#topicNav-search-clear").show().siblings(".fa").hide(),$("#topicNav li:visible:even").addClass("even"),$("#topicNav li:visible:odd").removeClass("even")):($("#topicNav li").show(),$("#topicNav-search-clear").hide().siblings(".fa").show(),s())})}FastClick.attach(document.body),$.getJSON("topics.json",function(t){topics=t,i()}),$.getJSON("help.json",function(t){$.each(t,function(){var t='<div class="help-item"><div class="help-question">'+this.question+'</div><div class="help-answer">'+this.answer+"</div></div>";$(t).appendTo(".help-items")}),$(".help-question").click(function(){$(this).toggleClass("open").siblings(".help-answer").toggle()}),$(".help-search").keyup(function(){""!=$(".help-search").val()?($(".help-item").hide(),$('.help-question:containsIN("'+$(".help-search").val()+'")').parent().show()):$(".help-item").show()})})});